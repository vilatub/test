TITLE
# Imbalanced Data: –¢–µ—Ö–Ω–∏–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–ª–∞—Å—Å–∞–º–∏

## üéØ –¶–µ–ª–∏ –Ω–æ—É—Ç–±—É–∫–∞

1. **–ü–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã** –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–¢–µ—Ö–Ω–∏–∫–∏ sampling:** SMOTE, undersampling, hybrid
3. **Cost-sensitive learning** –∏ class weights
4. **Advanced:** Focal loss, threshold optimization
5. **–ü—Ä–∞–∫—Ç–∏–∫–∞:** Fraud detection —Å extreme imbalance

## üíº –ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞: Credit Card Fraud Detection

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ë–∞–Ω–∫ —Ö–æ—á–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

**–ü—Ä–æ–±–ª–µ–º–∞:**
- üí≥ **Extreme imbalance:** ~0.17% fraud (1:600 ratio!)
- üí∞ **–°—Ç–æ–∏–º–æ—Å—Ç—å –æ—à–∏–±–æ–∫:** FN (–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π fraud) –æ—á–µ–Ω—å –¥–æ—Ä–æ–≥–æ
- ‚ö° **Real-time:** –ù—É–∂–Ω—ã –±—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
- üéØ **Precision:** –ú–Ω–æ–≥–æ FP = –Ω–µ–¥–æ–≤–æ–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã

**–ú–µ—Ç—Ä–∏–∫–∏:**
- **Precision:** –ò–∑ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö, —Å–∫–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω–æ fraud
- **Recall:** –ò–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö fraud, —Å–∫–æ–ª—å–∫–æ –ø–æ–π–º–∞–ª–∏
- **F1-score:** –ë–∞–ª–∞–Ω—Å precision/recall
- **PR-AUC:** Area –ø–æ–¥ Precision-Recall –∫—Ä–∏–≤–æ–π
- **Cost:** Weighted cost of FP and FN

---

THEORY1
## üìö –ß–∞—Å—Ç—å 1: –ü—Ä–æ–±–ª–µ–º–∞ Imbalanced Data

### 1.1 –ß—Ç–æ —Ç–∞–∫–æ–µ Imbalanced Data?

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** –î–∞–Ω–Ω—ã–µ, –≥–¥–µ –æ–¥–∏–Ω –∫–ª–∞—Å—Å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç –Ω–∞–¥ –¥—Ä—É–≥–∏–º.

**–°—Ç–µ–ø–µ–Ω—å –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞:**
- **Mild:** 1:4 (20% minority)
- **Moderate:** 1:10-1:100 (1-10% minority)
- **Extreme:** 1:100-1:1000+ (<1% minority)

**–ü—Ä–∏–º–µ—Ä—ã:**
| –ó–∞–¥–∞—á–∞ | Majority | Minority | Ratio |
|--------|----------|----------|-------|
| Email spam | Not spam | Spam | 1:10 |
| Fraud detection | Legit | Fraud | 1:100-1:1000 |
| Medical diagnosis | Healthy | Disease | 1:100+ |
| Manufacturing defects | OK | Defect | 1:1000+ |

**–ù–∞—à case:** Credit card fraud ~0.17% ‚Üí 1:600!

---

THEORY2
### 1.2 –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞?

#### –ü—Ä–æ–±–ª–µ–º–∞ 1: Biased Learning

ML –º–æ–¥–µ–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç **overall accuracy**:

$$\text{Accuracy} = \frac{TP + TN}{TP + TN + FP + FN}$$

–î–ª—è 1:600 imbalance, –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å **–≤—Å–µ–≥–¥–∞ majority –∫–ª–∞—Å—Å** –∏ –ø–æ–ª—É—á–∏—Ç—å 99.83% accuracy!

```python
# "–£–º–Ω–∞—è" –º–æ–¥–µ–ª—å
def predict_always_majority(x):
    return 0  # Always predict "not fraud"

# Accuracy –Ω–∞ 1:600 imbalance
accuracy = 599 / 600 = 99.83%  # –û—Ç–ª–∏—á–Ω–æ!
```

–ù–æ —ç—Ç–∞ –º–æ–¥–µ–ª—å **–±–µ—Å–ø–æ–ª–µ–∑–Ω–∞** - –Ω–µ –ª–æ–≤–∏—Ç –Ω–∏ –æ–¥–∏–Ω fraud!

#### –ü—Ä–æ–±–ª–µ–º–∞ 2: Gradient Domination

–í gradient-based –º–µ—Ç–æ–¥–∞—Ö (neural nets, boosting):

$$\nabla L = \sum_{i=1}^n \nabla L_i$$

Majority –ø—Ä–∏–º–µ—Ä—ã –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç –≥—Ä–∞–¥–∏–µ–Ω—Ç ‚Üí –º–æ–¥–µ–ª—å –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç minority!

#### –ü—Ä–æ–±–ª–µ–º–∞ 3: Decision Boundary

–° –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º minority –ø—Ä–∏–º–µ—Ä–æ–≤, —Å–ª–æ–∂–Ω–æ –≤—ã—É—á–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≥—Ä–∞–Ω–∏—Ü—É:

```
Majority: oooooooooooooooooooooooo
Minority:           x           
```

–ì—Ä–∞–Ω–∏—Ü–∞ –±—É–¥–µ—Ç –Ω–µ—Ç–æ—á–Ω–æ–π –∏–ª–∏ overfit –∫ –º–∞–ª–æ–º—É —á–∏—Å–ª—É –ø—Ä–∏–º–µ—Ä–æ–≤.

---
